<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Painter</title>
    <link rel="stylesheet" href="style.css">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@100..900&family=Noto+Sans+TC:wght@100..900&display=swap"
        rel="stylesheet">

    <link rel="stylesheet"
        href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
        crossorigin="anonymous"></script>
</head>

<script src="app.js"></script>

<body class="" onload="init()">
    <div class="flex" style="height: 100vh;">
        <!-- tool area -->
        <section id="tool-area" class="w-1/3 md:w-1/4 p-5 overflow-scroll relative">
            <div>
                <!-- title bar -->
                <div class="flex flex-wrap justify-between items-center">
                    <h2 class="mb-0 font-bold">Painter</h2>
                    <div>
                        <button id="undo-btn" class="btn btn-icon" onclick="canvasUndo()">
                            <span class="material-symbols-rounded">undo</span>
                        </button>
                        <button id="redo-btn" class="btn btn-icon" onclick="canvasRedo()">
                            <span class="material-symbols-rounded">redo</span>
                        </button>
                        <button class="btn btn-icon" onclick="openModal('reset-dialog')">
                            <span class="material-symbols-rounded">delete</span>
                        </button>
                    </div>
                </div>

                <!-- upload download -->
                <div class="flex mt-5 gap-2">
                    <button onClick="openModal('new-dialog')" class="btn btn-dark w-1/2">
                        <span class="material-symbols-rounded">draft</span>
                        New
                    </button>
                    <button class="btn btn-primary w-1/2" onclick="download()">
                        <span class="material-symbols-rounded">download</span>
                        Download
                    </button>
                </div>

                <!-- pen selector -->
                <div class="mt-5 flex flex-wrap gap-2">
                    <label for="tool-draw" class="btn-tool-group">
                        <input type="radio" name="tool" class="form-hidden" id="tool-draw" value="draw" checked>
                        <div class="btn btn-tool">
                            <span class="material-symbols-rounded">edit</span>
                        </div>
                    </label>
                    <label for="tool-erase" class="btn-tool-group">
                        <input type="radio" name="tool" class="form-hidden" id="tool-erase" value="erase">
                        <div class="btn btn-tool">
                            <span class="material-symbols-rounded">ink_eraser</span>
                        </div>
                    </label>
                    <label for="tool-text" class="btn-tool-group">
                        <input type="radio" name="tool" class="form-hidden" id="tool-text" value="text">
                        <div class="btn btn-tool">
                            <span class="material-symbols-rounded">format_shapes</span>
                        </div>
                    </label>
                    <label for="tool-circle" class="btn-tool-group">
                        <input type="radio" name="tool" class="form-hidden" id="tool-circle" value="circle">
                        <div class="btn btn-tool">
                            <span class="material-symbols-rounded">circle</span>
                        </div>
                    </label>
                    <label for="tool-rect" class="btn-tool-group">
                        <input type="radio" name="tool" class="form-hidden" id="tool-rect" value="rect">
                        <div class="btn btn-tool">
                            <span class="material-symbols-rounded">square</span>
                        </div>
                    </label>
                    <label for="tool-triangle" class="btn-tool-group">
                        <input type="radio" name="tool" class="form-hidden" id="tool-triangle" value="triangle">
                        <div class="btn btn-tool">
                            <span class="material-symbols-rounded">change_history</span>
                        </div>
                    </label>
                    <label for="tool-line" class="btn-tool-group">
                        <input type="radio" name="tool" class="form-hidden" id="tool-line" value="line">
                        <div class="btn btn-tool">
                            <span class="material-symbols-rounded">pen_size_2</span>
                        </div>
                    </label>
                    <label for="tool-rainbow" class="btn-tool-group">
                        <input type="radio" name="tool" class="form-hidden" id="tool-rainbow" value="rainbow">
                        <div class="btn btn-tool">
                            <span class="material-symbols-rounded">looks</span>
                        </div>
                    </label>
                    <!-- <label for="tool-smile" class="btn-tool-group">
                    <input type="radio" name="tool" class="form-hidden" id="tool-smile" value="smile">
                    <div class="btn btn-tool">
                        <span class="material-symbols-rounded">sticker</span>
                    </div>
                </label> -->
                </div>

                <!-- font selector -->
                <div id="font-area" class="flex mt-5 gap-2 hidden">
                    <select class="form-input" id="font-style" style="width: 65%;">
                        <option style="font-family: serif;" value="serif">Serif</option>
                        <option style="font-family: sans-serif;" value="sans-serif">Sans-serif</option>
                        <option style="font-family: monospace;" value="monospace">Monospace</option>
                        <option style="font-family: Arial;" value="Arial">Arial</option>
                        <option style="font-family: Inter;" value="Inter">Inter</option>
                        <option style="font-family: 微軟正黑體;" value="微軟正黑體">微軟正黑體</option>
                        <option style="font-family: 標楷體;" value="標楷體">標楷體</option>
                        <option style="font-family: 新細明體;" value="新細明體">新細明體</option>
                        <option style="font-family: 思源黑體;" value="Noto Sans Tc">思源黑體</option>
                    </select>
                    <select class="form-input" id="font-size" style="width: 35%;">
                        <option value="8">8</option>
                        <option value="10">10</option>
                        <option value="12">12</option>
                        <option value="14">14</option>
                        <option value="18">18</option>
                        <option value="26" selected>26</option>
                        <option value="38">38</option>
                        <option value="46">46</option>
                        <option value="64">64</option>
                        <option value="72">72</option>
                        <option value="100">100</option>
                    </select>
                </div>

                <!-- type -->
                <div id="fill-type-area" class="mt-5 text-center hidden">
                    <div class="btn-group" role="group" aria-label="Basic radio toggle button group">
                        <label class="btn-tab-container" for="stroke">
                            <input type="radio" class="form-hidden" name="fill-type" id="stroke" autocomplete="off"
                                checked value="0">
                            <div class="btn btn-tab">Stroke</div>
                        </label>
                        <label class="btn-tab-container" class="btn btn-tab" for="filled">
                            <input type="radio" class="form-hidden" name="fill-type" id="filled" autocomplete="off"
                                value="1">
                            <div class="btn btn-tab">Fill</div>
                        </label>
                    </div>
                </div>

                <!-- thickness -->
                <div id="thickness-area" class="mt-5 flex items-center">
                    <span class="material-symbols-rounded text-slate-500 me-3">line_weight</span>
                    <input type="range" class="form-range value-thickness" id="thickness"
                        oninput="changeThickness(this.value)" min="1" max="100" value="25">
                </div>

                <!-- color selection -->
                <div id="color-selection-area">
                    <div id="color-choices" class="flex flex-wrap gap-3 mt-5 justify-center">
                        <button class="color-selection color-selection-active" style="background: rgb(0, 0, 0);"
                            onclick="chooseColor('rgb(0, 0, 0)')"></button>
                        <button class="color-selection" style="background: rgb(244, 67, 54);"
                            onclick="chooseColor('rgb(244, 67, 54)')"></button>
                        <button class="color-selection" style="background: rgb(255, 152, 0);"
                            onclick="chooseColor('rgb(255, 152, 0)')"></button>
                        <button class="color-selection" style="background: rgb(76, 175, 80)"
                            onclick="chooseColor('rgb(76, 175, 80)')"></button>
                        <button class="color-selection" style="background: rgb(33, 150, 243);"
                            onclick="chooseColor('rgb(33, 150, 243)')"></button>
                        <button class="color-selection" style="background: rgb(103, 58, 183);"
                            onclick="chooseColor('rgb(103, 58, 183)')"></button>
                    </div>
                    <div class="flex mt-5 justify-center gap-2">
                        <div class="p-2" style="width: 50px; height: 175px;">
                            <span id="color-label" class="color-selection m-1" style="background: salmon;"></span>
                            <button class="btn btn-icon m-auto" onclick="addColor();">
                                <span class="material-symbols-rounded">add_circle</span>
                            </button>
                        </div>
                        <div id="color-block-container" style="width: 175px; height: 175px; position: relative;">
                            <canvas id="color-block" width="175px" height="175px"></canvas>
                            <span id="color-block-indicator" style="top: -2px; left: 173px;"></span>
                        </div>
                        <div id="color-hue-container" style="width: 40px; height: 175px; position: relative;">
                            <canvas id="color-hue" width="40px" height="175px"></canvas>
                            <span id="color-hue-indicator" style="top: 0px; left: 0px;"></span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- scale area -->
            <div id="scale-area" class="mt-5 flex items-center gap-3">
                <!-- <span class="material-symbols-rounded text-slate-500">search</span> -->
                <p id="scale-value" class="text-sm text-slate-500">100%</p>
                <button class="btn btn-icon" onclick="changeScale(scale - 10)">
                    <span class="material-symbols-rounded">zoom_out</span>
                </button>
                <input type="range" class="form-range value-scale" step="10" oninput="changeScale(this.value)"
                    id="scale" min="10" max="250" value="100">
                <button class="btn btn-icon" onclick="changeScale(scale + 10)">
                    <span class="material-symbols-rounded">zoom_in</span>
                </button>
                <button class="btn btn-icon" onclick="changeScale(100)">
                    <span class="material-symbols-rounded">fullscreen</span>
                </button>
            </div>
        </section>

        <!-- draw area -->
        <section id="draw-area" class="w-2/3 md:w-3/4 p-5 text-center overflow-scroll" style="height: 100vh;">
            <div id="canvas-container" class="draw">
                <canvas id="canvas-bg" width="1000px" height="700px">OUO</canvas>
                <canvas id="canvas" width="1000px" height="700px">OWO</canvas>
                <canvas id="canvas-preview" width="1000px" height="700px">OAO</canvas>
            </div>
        </section>
    </div>

    <!-- Reset Dialog -->
    <div id="reset-dialog" class="hidden modal-container">
        <!-- <span class="modal-bg"></span> -->
        <div class="modal">
            <div class="modal-head">
                <h3>Reset</h3>
            </div>
            <div class="modal-body">
                <p>Are you sure?</p>
            </div>
            <div class="modal-foot">
                <button class="btn btn-secondary" onclick="closeModal('reset-dialog')">Cancel</button>
                <button class="btn btn-primary" onclick="resetCanvas();closeModal('reset-dialog');">Reset</button>
            </div>
        </div>
    </div>

    <!-- New Dialog -->
    <div id="new-dialog" class="hidden modal-container">
        <!-- <span class="modal-bg"></span> -->
        <div class="modal">
            <div class="modal-head">
                <h3>Create new canvas</h3>
            </div>
            <div class="modal-body">
                <div class="w-full text-center">
                    <div class="btn-group">
                        <label class="btn-tab-container" for="photo-option"
                            onclick="switchTab('new-type', 'new-photo', 'photo-option')">
                            <input type="radio" class="form-hidden" name="new-type" id="photo-option" autocomplete="off"
                                checked>
                            <div class="btn btn-tab">Photo</div>
                        </label>
                        <label class="btn-tab-container" class="btn btn-tab" for="blank-option"
                            onclick="switchTab('new-type', 'new-blank', 'blank-option')">
                            <input type="radio" class="form-hidden" name="new-type" id="blank-option"
                                autocomplete="off">
                            <div class="btn btn-tab">Blank</div>
                        </label>
                    </div>
                </div>
            </div>

            <div id="new-type">
                <section id="new-photo">
                    <div class="modal-body text-center">
                        <span class="material-symbols-rounded text-slate-500" style="font-size: 100px;">landscape</span>
                        <p class="text-slate-500">Upload your photo to continue</p>
                    </div>
                    <div class="modal-foot">
                        <button class="btn btn-secondary w-full" onclick="closeModal('new-dialog')">Cancel</button>
                        <label for="file-upload" class="w-full btn btn-primary">
                            <input type="file" id="file-upload" class="form-hidden">

                            <!-- <span class="material-symbols-rounded">image</span> -->
                            Upload

                        </label>
                    </div>
                </section>
                <section id="new-blank" class="hidden">

                    <div class="modal-body">
                        <div>
                            <h5 class="text-slate-500 mb-1">Dimension</h5>
                            <div class="flex items-center gap-2">
                                <input type="number" id="new-width" name="new-width" min="10" max="10000"
                                    class="form-input w-1/2" value="1000" placeholder="1000">
                                <span class="material-symbols-rounded text-base text-slate-500">close</span>
                                <input type="number" id="new-height" name="new-height" min="10" max="10000"
                                    class="form-input w-1/2" value="700" placeholder="700">
                            </div>
                            <p id="err-msg" class="mt-1"></p>
                        </div>
                        <div class="mt-5">
                            <h5 class="text-slate-500 mb-1">Background Color</h5>
                        </div>
                        <input type="color" name="new-bg-color" id="new-bg-color" value="#FFFFFF">
                        <div class="mt-5 text-center">
                            <button class="btn btn-link" onclick="resetDimension()">
                                <span class="material-symbols-rounded">restart_alt</span>
                                Reset to default
                            </button>
                        </div>
                    </div>

                    <div class="modal-foot">
                        <button class="btn btn-secondary" onclick="closeModal('new-dialog')">Cancel</button>
                        <button type="submit" id="new-blank-btn" class="btn btn-primary"
                            onclick="newCanvas();closeModal('new-dialog');">Create</button>
                    </div>

                </section>
            </div>
        </div>
    </div>
</body>

</html>